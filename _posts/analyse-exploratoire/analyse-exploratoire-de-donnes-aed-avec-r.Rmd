---
title: "Analyse Exploratoire de donn√©es (AED) avec R"
description: "Les donn√©es brutes doivent √™tre inspect√©es , explor√©es pour de nouvelles hypoth√®ses et r√©par√©es afin d'augmenter la qualit√© et la sortie des donn√©es."
author:
- name: Ousmane Ouedraogo
  url: https://ousmane-ouedraogo.netlify.app
date: 2021-12-01
categories:
  - EDA
  - VISUALISATION
  - TIDYVERSE
output:
  distill::distill_article:
toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,fig.width = 10,
                      fig.height = 6, fig.retina = 2,
                      dev = "ragg_png", res = 1000,warning = FALSE)
```

## Introduction

L'analyse exploratoire des donn√©es ou AED, est une √©tape cruciale dans tout projet d'analyse de donn√©es ou de science des donn√©es. L'AED consiste √† d√©gager les grandes tendances des donn√©es, en particulier en r√©alisant des graphiques, tableaux et tests statistiques qui permettent de mettre en √©vidence les caract√©ristiques individuelles des variables et les relations entre elles.

Dans cet article vous apprendrez comment explorer vos donn√©es en toute simplicit√© et rapidit√© avec R. De nombreuses m√©thodes et librairies existent mais le but est d'acc√©l√©rer la partie calcul afin que vous ayez suffisamment du temps pour l'interpr√©tation des r√©sultats.

## Reproductibilit√©

Dans cette section nous vous pr√©sentons tout ce dont vous aurez besoin pour reproduire vous m√™me les codes sur votre ordinateur.

### Packages

Vous aurez besoin des librairies suivantes, installez-les si vous ne les avez pas. Ils sont tous disponible sur le CRAN.

```{r Packages , message=F}
library(tidyverse) # manipulation et visualisation de donn√©es
library(dlookr) # exploration des donn√©es
library(report) # rapport synth√©tis√©
library(extrafont) #
library(hrbrthemes)
library(rmarkdown)
extrafont::loadfonts()
```

### Jeu de donn√©es

Pour illustrer tous les calculs nous allons utiliser le jeu de donn√©es `penguins` contenu dans le package [palmerpenguins](https://allisonhorst.github.io/palmerpenguins/index.html "palmerpenguins") disponible sur le CRAN √©galement.

![The Palmer Archipelago penguins. Artwork by \@allison_horst](images/lter_penguins.png)

Un coup d'oeil rapide sur les donn√©es : 8 variables et 344 observations. √ßa pouvait √™tre pire üòÑ.

```{r}
library(palmerpenguins)
penguins %>% 
  rmarkdown::paged_table()
```

## Exploration num√©rique

Dans cette section, il va s'agir d'explorer les donn√©es d'un point de vue num√©rique, en calculant des statistiques utiles. Beaucoup de m√©thodes existent pour le faire mais j'opte pour le package `dlookr` mon coup de c≈ìur pour au moins trois raisons :

-   Il est simple, intuitif avec une syntaxe facile √† comprendre

-   Il s'int√®gre ais√©ment au verbe tidyverse, ce qui permet de le connecter √† bien de packages comme `report`, `ggplot2`, et pleins d'autres. Cette inter-combinaison croyez moi peu vous faire √©conomiser beaucoup en terme de temps!

-   Il est robuste, puissant et rapide.

Alors sans plus tard√© entrain dans le vif du sujet.

### Aper√ßu des donn√©es

Quand on acquiert les donn√©es on veut le plus souvent avoir une vue synth√©tique de celles ci. Cela permet de fixer clairement le nombre de variables, d'observations et le type de chaque variable. le package `report` permet de le faire et offre une vue g√©n√©rale et textuelle du jeu de donn√©es. Malheureusement la sortie est en anglais.

```{r}
penguins %>% 
  report() %>% 
  summary()
```

### Inspecter les donn√©es

L'inspection servira √† d√©crire les donn√©es, √† proposer des r√©sum√©s statistiques et une √©valuation des donn√©es manquantes (nombre et proportion) pour chaque variable selon son type.

-   Inspection g√©n√©rale de l'ensemble des donn√©es :

```{r}
penguins %>% 
  diagnose() %>% 
  rmarkdown::paged_table()
```

-   Inspection par type

```{r}
penguins %>% 
  diagnose_numeric() %>% 
  rmarkdown::paged_table()
```

En ex√©cutant ces lignes de codes vous avez les informations suivantes pour chaque variable variable num√©rique ! notez bien que les variables `species` et `sex`manquent ici. Vous connaisez la plupart des statistiques calcul√©es.

-   `zero` repr√©sente le nombre de valeurs nulles

-   `minus` le nombre de valeurs n√©gatives

-   `outlier` le nombre de valeurs potentiellement aberrantes.

Par contre le code ci dessous va renseign√© sur les variables cat√©gorielles :

```{r}
penguins %>% 
  diagnose_category() %>% 
  rmarkdown::paged_table()
```

-   `levels` les cat√©gories possible pour chaque variable

-   `N` = nombre d'observations pour chaque levels

-   `Freq` = la fr√©quence

-   `ratio` = la fr√©quence en termes de proportion

-   `rank` = le rang de chaque levels , dans chacune des variables

### R√©sum√©s statistiques

Il s'agit de calculer les statistiques cl√©s pour les diff√©rentes variables num√©riques. ici on peut faire d'une pierre deux, enfin trois coups car on a la possibilit√© de calculer √† la fois les param√®tres de position, de dispersion et les param√®tres de formes.

```{r}
penguins %>% 
  describe() %>% 
  rmarkdown::paged_table()
```

Ce bout de code calcule plein de statistiques int√©ressantes, en plus de cela nous montre aussi le nombre de donn√©es manquantes par variable. Extrayons les diff√©rentes statistiques par groupe pour plus de lisibilit√© :

```{r}
penguins %>% 
  describe() %>% 
  select(variable:kurtosis) %>% 
  rmarkdown::paged_table()
```

skewness (asym√©trie) et kurtosis (aplatissement) sont des param√®tres de forme calcul√© pour chaque variable.

Nous pouvons √©galement, d√©cider des quantiles √† calculer , par exemple ici les quintiles :

```{r}
penguins %>% 
  describe(quantiles =c(.20,.40,.60,.80)) %>% 
  select(variable,n,na,starts_with("p")) %>% 
  rmarkdown::paged_table()
```

### Lien entre les variables

En AED, on cherche aussi √† voir si des variables particuli√®res (par pair) sont corr√©l√©es. nous pouvons r√©aliser cela comme suit:

```{r, layout = "l-body-outset"}
penguins %>% 
  correlate() %>% 
  head(10) %>% 
  rmarkdown::paged_table()
```

Nous avons juste montr√© les 10 premi√®res valeurs. Par d√©faut la m√©thode utilis√©e est `pearson`. Nous pouvons √©galement sp√©cifier la m√©thode pour `spearman` ou `kendall`. Ici nous allons calculer les trois :

```{r}

# pearson
pearson <- penguins %>% 
  correlate(method = "pearson") %>% 
  rename(pearson_corr = coef_corr)
# spearman
spearman <- penguins %>% 
  correlate(method = "spearman") %>% 
  rename(spearman_corr = coef_corr)
# kendall 
kendall <- penguins %>% 
  correlate(method = "kendall") %>% 
  rename(kendall_corr = coef_corr)

# combinaison en une seule table

full_join(x = pearson,y = spearman) %>% 
  full_join(x = .,y = kendall) %>% 
  rmarkdown::paged_table()
```

## Exploration graphique

Nous allons √† pr√©sent voir comment explorer les donn√©es de fa√ßon visuelle √† travers des graphiques avec l'excellent package `ggplot2` . Personnalisation des gaphes :

```{r}
# theme global
theme_set(
  theme_ipsum_rc(base_size = 22,
                 plot_title_size = 30,
                 axis_title_size = 22,
                 caption_size = 22)
  )
```

### Nuage de points

Type de graphique qui utilise des points pour repr√©senter les valeurs de deux variables num√©riques diff√©rentes. La position de chaque point sur l'axe horizontal et vertical indique les valeurs d'un point de donn√©es individuel. Le nuage de points est utilis√© pour observer les relations entre les variables.

Pour en r√©aliser avec ggplot2 :

```{r}
ggplot(data = penguins,
       mapping = aes(x =bill_length_mm,y = bill_depth_mm))+
  geom_point(size = 3)+
  labs(title = "Bill length vs Bill depth",
       caption = "Data Science avec R - 2021, tous droits reserv√©s",
       x = "Bill Length (mm)",
       y = "Bill Depth (mm)"
       )
```

Une modification courante du nuage de point de base est l'ajout d'une troisi√®me variable. Les valeurs de cette troisi√®me variable peuvent √™tre cod√©es en modifiant la fa√ßon dont les points sont repr√©sent√©es. Pour une troisi√®me variable qui indique des valeurs cat√©gorielles (species par exemple), le codage le plus courant est la couleur des points. En donnant √† chaque point une couleur distincte, il est facile de montrer l'appartenance de chaque point √† un groupe sp√©cifique.

```{r}
ggplot(
  data = penguins,
       mapping = aes(x =bill_length_mm,
                     y = bill_depth_mm, colour = species) ) +
 geom_point(size = 3)+
  labs(title = "Bill length vs Bill depth",
       caption = "Data Science avec R - 2021, tous droits reserv√©s",
       x = "Bill Length (mm)",
       y = "Bill Depth (mm)"
       )+
  scale_colour_viridis_d()+
  theme(legend.position = "top")
```

Pour chaque groupe de points, il est maintenant ais√© de distinguer, appr√©cier la forme du nuage de points. Il est tout a fait possible d'avoir la m√™me information par species :

```{r}
ggplot(
  data = penguins,
       mapping = aes(x =bill_length_mm,
                     y = bill_depth_mm, colour = species) ) +
 geom_point(size = 3)+
  labs(title = "Bill length vs Bill depth",
       caption = "Data Science avec R - 2021, tous droits reserv√©s",
       x = "Bill Length (mm)",
       y = "Bill Depth (mm)"
       )+
  scale_colour_viridis_d()+
  theme(legend.position = "none",
        strip.text = element_text(size =22,hjust = .5),
        strip.background = element_rect(fill="gray") )+
  facet_wrap(~species)
```

### Histogramme

L'histogramme est un outil fr√©quemment utilis√© pour r√©sumer des donn√©es discr√®tes ou continues qui sont pr√©sent√©es par intervalles de valeurs. Il est souvent employ√© pour montrer les caract√©ristiques principales de la distribution des donn√©es de fa√ßon pratique. Il est utile pour r√©sumer de grands ensembles de donn√©es (plus de 100¬†observations). Il peut √©galement faciliter la d√©tection d'observations inhabituelles (valeurs aberrantes) ou les intervalles sans point de donn√©e.

Pour en r√©aliser avec ggplot2

```{r}
ggplot(data = penguins,mapping = aes(x = bill_length_mm)
         ) + 
  geom_histogram(bins = 30,alpha = .5)+
  labs(title = "Bill length by species",
       caption = "Data Science avec R - 2021, tous droits reserv√©s",
       x = "",
       y = "Bill Length (mm)")
```

Tout comme pour le nuage de points, une troisi√®me variable peut √™tre cod√©e et/ou utilis√©e pour s√©parer les histogrammes:

```{r}
ggplot(data = penguins, mapping = aes(x = bill_length_mm,
                       fill = species)
         ) + geom_histogram(bins = 30,alpha = .8)+
  labs(title = "Bill length by species",
       caption = "Data Science avec R - 2021, tous droits reserv√©s",
       x = "",
       y = "Bill Length (mm)")+
  scale_fill_viridis_d()
```

ou :

```{r}
ggplot(data = penguins, mapping = aes(x = bill_length_mm,
                       fill = species)
         ) + geom_histogram(bins = 30,alpha = .8)+
  labs(title = "Bill length by species",
       caption = "Data Science avec R - 2021, tous droits reserv√©s",
       x = "",
       y = "Bill Length (mm)")+
  scale_fill_viridis_d()+
  theme(legend.position = "none",
        strip.text = element_text(size =22,hjust = .5),
        strip.background = element_rect(fill="gray") )+
  facet_wrap(~species)
  
```

### Boite √† moustaches ou Boxplot

La bo√Æte √† moustaches, parfois appel√©e diagramme en bo√Æte ou diagramme de quartiles, est un type de diagramme qui permet de visualiser synth√©tiquement les donn√©es. Elle ne montre pas la distribution avec autant de d√©tails que l'histogramme, mais elle est particuli√®rement utile pour indiquer si une distribution est asym√©trique et s'il y a des valeurs potentiellement extr√™mes dans l'ensemble de donn√©es. La bo√Æte √† moustaches est √©galement id√©ale pour comparer des distributions, car elle fait appara√Ætre imm√©diatement le centre, la dispersion et l'√©tendue.

![](images/boxplot.png)

pour en r√©aliser avec ggplot2 :

```{r }
ggplot(data = penguins, aes(x = species, y = bill_length_mm, fill =species))+
  geom_boxplot(outlier.color = "red",outlier.size = 3)+
  labs(title = "Bill length by species",
       caption = "Data Science avec R - 2021, tous droits reserv√©s",
       x = "",
       y = "Bill Length (mm)")+
  scale_fill_viridis_d()+
  theme(legend.position = "none")
```

On peut superpos√© au boxplot, les points de donn√©es pour mieux apprecier visuellement la distribution de ceux-ci.

```{r , preview = TRUE}
ggplot(data = penguins, aes(x = species, y = bill_length_mm, fill =species))+
  geom_boxplot(outlier.color = "red",outlier.size = 3)+
  geom_jitter(size = 3,alpha = 0.5,width = .2)+
  labs(title = "Bill length by species",
       caption = "Data Science avec R - 2021, tous droits reserv√©s",
       x = "",
       y = "Bill Length (mm)")+
  scale_fill_viridis_d()+
  theme(legend.position = "none")
```

### Graphique Quantile-Quantile ou Q-Q plot

Le graphique quantile-quantile (Q-Q plot) est un outil de diagnostic largement utilis√© pour √©valuer les similitudes et les diff√©rences de distribution entre deux √©chantillons ind√©pendants √† une variable. Il s'agit √©galement d'un outil populaire pour v√©rifier la pertinence d'une distribution de probabilit√© sp√©cifi√©e pour des donn√©es univari√©es donn√©es.

```{r}
ggplot(data = penguins, aes(sample = bill_length_mm))+
  stat_qq(size = 3 )+stat_qq_line()+
  labs(title = "Bill length by species",
       caption = "Data Science avec R - 2021, tous droits reserv√©s",
       x = "Quantiles th√©oriques",
       y = "Bill Length (mm)")+
  scale_fill_viridis_d()+
  theme(legend.position = "none")
```

## Visualisation des donn√©es manquantes

Dans cette section nous allons voir comment visualiser les donn√©es manquantes dans un jeu de donn√©es et d'appr√©cier la distribution (pattern) de celles-ci √† l'int√©rieur de ce m√™me jeu de donn√©es. Nous reviendrons dans un autre article sur les techniques d'imputation des donn√©es manquantes

La fonction `plot_na_pareto()` permet de r√©aliser un aper√ßu synth√©tique et visuel des donn√©es manquantes. Nous reviendrons dans un autre article sur les techniques d'imputation des donn√©es manquantes

```{r}
penguins %>% 
  plot_na_pareto(only_na = TRUE,relative = TRUE)
```

## Conclusion

Cet article est une introduction √† l'Analyse Exploratoire des Donn√©es. Des m√©thodes avanc√©es et encore plus robustes existent. J'esp√®re que cet article va constituer un bon point de d√©part pour vous dans vos travaux de recherches et d'analyse. N'h√©sitez pas √† partager vos r√©actions en commentaires.

## Session info

Analyses were conducted using the R Statistical language (version 4.0.5; R Core Team, 2021) on macOS Big Sur 11.6.1, using the packages hrbrthemes (version 0.8.0; Bob Rudis, 2020), dlookr (version 0.5.2; Choonghyun Ryu, 2021), ggplot2 (version 3.3.5; Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.), stringr (version 1.4.0; Hadley Wickham, 2019), forcats (version 0.5.1; Hadley Wickham, 2021), tidyr (version 1.1.4; Hadley Wickham, 2021), readr (version 2.1.0; Hadley Wickham and Jim Hester, 2021), dplyr (version 1.0.7; Hadley Wickham et al., 2021), kableExtra (version 1.3.4; Hao Zhu, 2021), palmerpenguins (version 0.1.0; Horst AM et al., 2020), tibble (version 3.1.6; Kirill M√ºller and Hadley Wickham, 2021), purrr (version 0.3.4; Lionel Henry and Hadley Wickham, 2020), report (version 0.4.0; Makowski et al., 2020), naniar (version 0.6.1; Nicholas Tierney et al., 2021), tidyverse (version 1.3.1; Wickham et al., 2019) and extrafont (version 0.17; Winston Chang, 2014).

References

------------------------------------------------------------------------

-   Bob Rudis (2020). hrbrthemes: Additional Themes, Theme Components and Utilities for 'ggplot2'. R package version 0.8.0. <https://CRAN.R-project.org/package=hrbrthemes>

-   Choonghyun Ryu (2021). dlookr: Tools for Data Diagnosis, Exploration, Transformation. R package version 0.5.2. <https://CRAN.R-project.org/package=dlookr>

-   H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.

-   Hadley Wickham (2019). stringr: Simple, Consistent Wrappers for Common String Operations. R package version 1.4.0. <https://CRAN.R-project.org/package=stringr>

-   Hadley Wickham (2021). forcats: Tools for Working with Categorical Variables (Factors). R package version 0.5.1. <https://CRAN.R-project.org/package=forcats>

-   Hadley Wickham (2021). tidyr: Tidy Messy Data. R package version 1.1.4. <https://CRAN.R-project.org/package=tidyr>

-   Hadley Wickham and Jim Hester (2021). readr: Read Rectangular Text Data. R package version 2.1.0. <https://CRAN.R-project.org/package=readr>

-   Hadley Wickham, Romain Fran√ßois, Lionel Henry and Kirill M√ºller (2021). dplyr: A Grammar of Data Manipulation. R package version 1.0.7. <https://CRAN.R-project.org/package=dplyr>

-   Hao Zhu (2021). kableExtra: Construct Complex Table with 'kable' and Pipe Syntax. R package version 1.3.4. <https://CRAN.R-project.org/package=kableExtra>

-   Horst AM, Hill AP, Gorman KB (2020). palmerpenguins: Palmer Archipelago (Antarctica) penguin data. R package version 0.1.0. <https://allisonhorst.github.io/palmerpenguins/>

-   Kirill M√ºller and Hadley Wickham (2021). tibble: Simple Data Frames. R package version 3.1.6. <https://CRAN.R-project.org/package=tibble>

-   Lionel Henry and Hadley Wickham (2020). purrr: Functional Programming Tools. R package version 0.3.4. <https://CRAN.R-project.org/package=purrr>

-   Makowski, D., Ben-Shachar, M.S., Patil, I. & L√ºdecke, D. (2020). Automated Results Reporting as a Practical Tool to Improve Reproducibility and Methodological Best Practices Adoption. CRAN. Available from <https://github.com/easystats/report.> doi: .

-   Nicholas Tierney, Di Cook, Miles McBain and Colin Fay (2021). naniar: Data Structures, Summaries, and Visualisations for Missing Data. R package version 0.6.1. <https://CRAN.R-project.org/package=naniar>

-   R Core Team (2021). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL <https://www.R-project.org/.>

-   Wickham et al., (2019). Welcome to the tidyverse. Journal of Open Source Software, 4(43), 1686, <https://doi.org/10.21105/joss.01686>

-   Winston Chang, (2014). extrafont: Tools for using fonts. R package version 0.17. <https://CRAN.R-project.org/package=extrafont>
